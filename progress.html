<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progress - Food Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }
        .bg-primary-gradient {
            background-image: linear-gradient(to right, #ec4899, #d946ef);
        }
        .text-primary-gradient {
            background-image: linear-gradient(to right, #ec4899, #d946ef);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Styling untuk custom input */
        .form-input-custom {
            background-color: rgba(229, 231, 235, 0.5); /* gray-200/50 */
            border: none;
            transition: box-shadow 0.2s;
        }
        .form-input-custom:focus {
            box-shadow: 0 0 0 2px rgba(236, 72, 153, 0.5); /* ring-pink-500/50 */
            outline: none;
        }

        /* ====================================================== */
        /* CSS KHUSUS UNTUK EMBLEM MENU DAN OVERLAY               */
        /* ====================================================== */

        #menu-overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(249, 250, 251, 0.4); 
            backdrop-filter: blur(3px);
            z-index: 40;
            opacity: 1;
            transform: scale(1);
            transform-origin: 50% calc(100% - 80px);
            transition: opacity 0.3s ease-in-out, transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            -webkit-mask-image: radial-gradient(circle at 50% calc(100% - 80px), black 200px, transparent 300px);
            mask-image: radial-gradient(circle at 50% calc(100% - 80px), black 200px, transparent 300px);
        }
        #menu-overlay.hidden {
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
        }

        #emblem-menu {
            position: absolute;
            bottom: 80px; 
            left: 50%;
            width: 280px; 
            height: 200px;
            margin-left: -140px;
            z-index: 50;
            pointer-events: none; 
        }

        @keyframes fly-out-1 {
            from { transform: translateY(0) scale(0.1) rotate(-180deg); opacity: 0; }
            to { transform: translateX(-65px) translateY(-25px) scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes fly-out-2 {
            from { transform: translateY(0) scale(0.1) rotate(-180deg); opacity: 0; }
            to { transform: translateX(-105px) translateY(-90px) scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes fly-out-3 {
            from { transform: translateY(0) scale(0.1) rotate(-180deg); opacity: 0; }
            to { transform: translateX(0px) translateY(-130px) scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes fly-out-4 {
            from { transform: translateY(0) scale(0.1) rotate(-180deg); opacity: 0; }
            to { transform: translateX(105px) translateY(-90px) scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes fly-out-5 {
            from { transform: translateY(0) scale(0.1) rotate(-180deg); opacity: 0; }
            to { transform: translateX(65px) translateY(-25px) scale(1) rotate(0deg); opacity: 1; }
        }

        .emblem-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 72px;
            height: 72px;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-decoration: none;
            color: #4b5563;
            position: absolute;
            left: 50%;
            bottom: 0;
            margin-left: -36px;
            pointer-events: none;
            opacity: 0;
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        }

        #emblem-menu.hidden .emblem-item {
            opacity: 0;
            pointer-events: none;
            animation: none;
        }

        #emblem-menu:not(.hidden) .emblem-item {
            pointer-events: auto;
            animation-duration: 0.6s;
            animation-fill-mode: forwards;
            animation-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        #emblem-menu:not(.hidden) .emblem-item:nth-child(1) {
            animation-name: fly-out-1;
            animation-delay: 0s;
        }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(2) {
            animation-name: fly-out-2;
            animation-delay: 0.08s;
        }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(3) {
            animation-name: fly-out-3;
            animation-delay: 0.16s;
        }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(4) {
            animation-name: fly-out-4;
            animation-delay: 0.24s;
        }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(5) {
            animation-name: fly-out-5;
            animation-delay: 0.32s;
        }
        
        #emblem-menu:not(.hidden) .emblem-item:nth-child(1):hover { transform: translateX(-65px) translateY(-25px) scale(1.1); }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(2):hover { transform: translateX(-105px) translateY(-90px) scale(1.1); }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(3):hover { transform: translateX(0px) translateY(-130px) scale(1.1); }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(4):hover { transform: translateX(105px) translateY(-90px) scale(1.1); }
        #emblem-menu:not(.hidden) .emblem-item:nth-child(5):hover { transform: translateX(65px) translateY(-25px) scale(1.1); }

        .emblem-item:hover {
            box-shadow: 0 8px 16px rgba(236, 72, 153, 0.3);
        }

        .emblem-item svg {
            width: 28px;
            height: 28px;
            color: #ec4899;
            margin-bottom: 4px;
        }
        
        .emblem-item span {
            font-size: 10px;
            font-weight: 500;
            text-align: center;
        }

    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-md mx-auto bg-gray-50 rounded-2xl shadow-xl relative h-[800px] overflow-hidden">
        
        <div class="absolute top-0 -left-16 w-72 h-72 bg-pink-300 rounded-full opacity-30 filter blur-3xl"></div>
        <div class="absolute bottom-0 -right-16 w-72 h-72 bg-purple-300 rounded-full opacity-30 filter blur-3xl"></div>

        <div class="relative z-10 h-full flex flex-col p-6 pt-8">
            <div class="flex-shrink-0 flex items-center mb-6">
                <a href="diary.html" class="p-2 -ml-2 text-gray-600 hover:text-gray-900 rounded-full hover:bg-white/30 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                </a>
                <h1 class="text-xl font-bold text-center flex-grow text-gray-900">Progress</h1>
                <div class="w-10"></div> </div>

            <div class="flex-shrink-0 mb-6 p-1 bg-gray-200/50 rounded-full flex items-center space-x-1">
                <button id="weight-tab-btn" class="flex-1 text-center py-2 px-4 rounded-full text-sm font-semibold bg-white shadow text-pink-500 transition-all duration-300">Weight</button>
                <button id="measurement-tab-btn" class="flex-1 text-center py-2 px-4 rounded-full text-sm font-semibold text-gray-500 transition-all duration-300">Measurement</button>
            </div>

            <div class="flex-grow overflow-y-auto -mr-4 pr-4">
                <div id="weight-view" class="space-y-4">
                    <div class="glass-card rounded-xl p-4">
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <p class="text-sm text-gray-600 mb-1">Latest Weight</p>
                                <p id="latest-weight-display" class="text-3xl font-bold text-gray-900">-- kg</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600 mb-1">Goal Weight</p>
                                <p id="goal-weight-display" class="text-3xl font-bold text-primary-gradient">-- kg</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 mt-4">
                            <button id="set-goal-btn" class="bg-white/80 text-gray-800 font-semibold py-2.5 px-4 rounded-lg shadow-sm">Set Goal</button>
                            <button id="update-weight-btn" class="bg-primary-gradient text-white font-semibold py-2.5 px-4 rounded-lg shadow-lg">Update Weight</button>
                        </div>
                    </div>
                    <div class="glass-card rounded-xl p-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="font-bold text-gray-900">History & Trend</h2>
                            <select id="history-filter" class="form-input-custom text-sm py-1 px-2 rounded-md">
                                <option value="4w">Last 4 weeks</option>
                                <option value="3m">Last 3 months</option>
                                <option value="6m">Last 6 months</option>
                                <option value="all">All Time</option>
                            </select>
                        </div>
                        <div><canvas id="weight-chart"></canvas></div>
                        <div class="mt-4 border-t border-gray-200/50 pt-3">
                            <h3 class="font-semibold mb-2 text-gray-800">Weight History</h3>
                            <div id="weight-history-list" class="max-h-40 overflow-y-auto space-y-2 pr-2"></div>
                        </div>
                    </div>
                </div>

                <div id="measurement-view" class="hidden space-y-4">
                    <div class="glass-card rounded-xl p-4">
                        <div class="flex justify-between items-center mb-4">
                            <button id="prev-day-btn" class="p-2 rounded-full hover:bg-white/30 transition-colors text-gray-500">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                            </button>
                            <h2 id="measurement-date-display" class="font-bold text-lg text-gray-900 cursor-pointer">Today</h2>
                            <button id="next-day-btn" class="p-2 rounded-full hover:bg-white/30 transition-colors text-gray-500">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                            </button>
                        </div>
                        <div id="measurement-form" class="grid grid-cols-2 gap-x-4 gap-y-3">
                            <div>
                                <label class="text-sm font-medium text-gray-700">Neck (cm)</label>
                                <input type="number" step="0.1" name="neck" placeholder="--" class="form-input-custom w-full p-2 mt-1 rounded-md text-sm">
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-700">Waist (cm)</label>
                                <input type="number" step="0.1" name="waist" placeholder="--" class="form-input-custom w-full p-2 mt-1 rounded-md text-sm">
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-700">Chest (cm)</label>
                                <input type="number" step="0.1" name="chest" placeholder="--" class="form-input-custom w-full p-2 mt-1 rounded-md text-sm">
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-700">Hips (cm)</label>
                                <input type="number" step="0.1" name="hips" placeholder="--" class="form-input-custom w-full p-2 mt-1 rounded-md text-sm">
                            </div>
                        </div>
                        <button id="save-measurement-btn" class="w-full mt-4 bg-primary-gradient text-white font-semibold py-2.5 px-4 rounded-lg shadow-lg">Save Measurement</button>
                    </div>
                    <div class="glass-card rounded-xl p-4">
                        <h2 class="font-bold mb-2 text-gray-900">Measurement History</h2>
                        <div id="measurement-history-list" class="max-h-48 overflow-y-auto space-y-3 pr-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="update-weight-modal" class="hidden fixed inset-0 z-40 flex items-center justify-center p-4">
            <div class="absolute inset-0 bg-gray-800/40 backdrop-blur-sm"></div>
            <div class="glass-card rounded-xl p-6 w-full max-w-sm relative">
                <h2 class="text-lg font-bold mb-4 text-gray-900">Update Weight</h2>
                <div class="mb-4">
                    <label class="font-semibold text-gray-800">Date</label>
                    <input id="entry-date-input" type="date" class="form-input-custom w-full p-2 mt-1 rounded-md">
                </div>
                <div>
                    <label class="font-semibold text-gray-800">Weight (kg)</label>
                    <input id="new-weight-input" type="number" step="0.1" placeholder="e.g. 70.5" class="form-input-custom w-full p-2 mt-1 rounded-md">
                </div>
                <div class="flex justify-end gap-2 mt-6">
                    <button id="cancel-update-btn" class="bg-gray-200/80 text-gray-800 font-semibold py-2 px-4 rounded-lg">Cancel</button>
                    <button id="save-weight-btn" class="bg-primary-gradient text-white font-semibold py-2 px-4 rounded-lg">Save</button>
                </div>
            </div>
        </div>
        
        <div id="set-goal-modal" class="hidden fixed inset-0 z-40 flex items-center justify-center p-4">
            <div class="absolute inset-0 bg-gray-800/40 backdrop-blur-sm"></div>
            <div class="glass-card rounded-xl p-6 w-full max-w-sm relative">
                <h2 class="text-lg font-bold mb-4 text-gray-900">Set Your Goal Weight</h2>
                <label class="text-gray-800">Goal Weight (kg)</label>
                <input id="new-goal-input" type="number" step="0.1" placeholder="e.g. 65" class="form-input-custom w-full p-2 mt-1 rounded-md">
                <div class="flex justify-end gap-2 mt-6">
                    <button id="cancel-goal-btn" class="bg-gray-200/80 text-gray-800 font-semibold py-2 px-4 rounded-lg">Cancel</button>
                    <button id="save-goal-btn" class="bg-primary-gradient text-white font-semibold py-2 px-4 rounded-lg">Save</button>
                </div>
            </div>
        </div>
        
        <div id="menu-overlay" class="hidden"></div>
        <div id="emblem-menu" class="hidden">
            <a href="add-food.html" class="emblem-item">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                <span>Add Food</span>
            </a>
            <a href="progress.html" class="emblem-item">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                <span>Progress</span>
            </a>
            <a href="create.html" class="emblem-item">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                <span>Create Post</span>
            </a>
            <a href="workout.html" class="emblem-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 3.03v.568c0 .334.148.65.405.864l1.068.89c.442.369.535 1.024.217 1.464l-.657.98c-.318.476-.945.642-1.464.325l-1.068-.89a.993.993 0 00-1.218 0l-1.068.89c-.519.317-1.146.15-1.464-.325l-.657-.98c-.318-.44-.225-1.095.217-1.464l1.068-.89a.993.993 0 00.405-.864v-.568a3 3 0 013-3c.954 0 1.84.464 2.404 1.224a2.998 2.998 0 01.596 2.776zM21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                <span>Workout</span>
            </a>
            <a href="challenge.html" class="emblem-item">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l1.8-2.4c.4-.5 1-.8 1.7-.8h.9c.7 0 1.3.3 1.7.8L17 6v13m-2-4h-4m-6-4h16"></path></svg>
                <span>Challenge</span>
            </a>
        </div>
        <nav class="absolute bottom-4 left-1/2 -translate-x-1/2 w-[95%] max-w-sm z-30 glass-card grid grid-cols-5 items-center p-2 rounded-2xl">
            <a href="community.html" class="flex flex-col items-center text-gray-600 py-1 hover:text-pink-500">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                <span class="text-xs">Community</span>
            </a>
            <a href="diary.html" class="flex flex-col items-center text-gray-600 py-1 hover:text-pink-500">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1 rotate-180" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M5 3h4"></path><path d="M7 3v12"></path><path d="M4 15h6v3a3 3 0 0 1 -6 0v-3z"></path><path d="M14 21v-3a3 3 0 0 1 6 0v3"></path><path d="M17 21v-18"></path></svg>
                <span class="text-xs">Diary</span>
            </a>
            <button id="plus-button" class="bg-primary-gradient text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg -mt-6 transform hover:scale-110 transition-transform">
                <svg class="w-8 h-8 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
            </button>
            <a href="marketplace.html" class="flex flex-col items-center text-gray-600 py-1 hover:text-pink-500">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                <span class="text-xs">Marketplace</span>
            </a>
            <a href="profile.html" class="flex flex-col items-center text-gray-600 py-1 hover:text-pink-500">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                <span class="text-xs">Profile</span>
            </a>
        </nav>
    </div>

    <script>
        // JAVASCRIPT UNTUK MENU EMBLEM
        document.addEventListener('DOMContentLoaded', () => {
            const plusButton = document.getElementById('plus-button');
            const plusIcon = plusButton.querySelector('svg');
            const emblemMenu = document.getElementById('emblem-menu');
            const menuOverlay = document.getElementById('menu-overlay');

            if (plusButton && emblemMenu && menuOverlay) {
                plusButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const isHidden = emblemMenu.classList.toggle('hidden');
                    menuOverlay.classList.toggle('hidden');
                    plusIcon.style.transform = isHidden ? 'rotate(0deg)' : 'rotate(45deg)';
                });
                menuOverlay.addEventListener('click', () => {
                    emblemMenu.classList.add('hidden');
                    menuOverlay.classList.add('hidden');
                    plusIcon.style.transform = 'rotate(0deg)';
                });
            }
        });

        // JAVASCRIPT UNTUK HALAMAN PROGRESS (digabung dari progress.js)
        document.addEventListener('DOMContentLoaded', function() {
            // ... (Kode progress.js yang kamu berikan akan diletakkan di sini, dengan beberapa penyesuaian)
            
            // --- Penyesuaian untuk Redesign ---
            const weightTab = document.getElementById('weight-tab-btn');
            const measurementTab = document.getElementById('measurement-tab-btn');
            
            // --- Elemen Umum ---
            const weightView = document.getElementById('weight-view');
            const measurementView = document.getElementById('measurement-view');
            
            // Event listener untuk Tab Switcher
            weightTab.addEventListener('click', () => {
                weightView.classList.remove('hidden');
                measurementView.classList.add('hidden');
                weightTab.classList.add('bg-white', 'shadow', 'text-pink-500');
                measurementTab.classList.remove('bg-white', 'shadow', 'text-pink-500');
            });
            measurementTab.addEventListener('click', () => {
                measurementView.classList.remove('hidden');
                weightView.classList.add('hidden');
                measurementTab.classList.add('bg-white', 'shadow', 'text-pink-500');
                weightTab.classList.remove('bg-white', 'shadow', 'text-pink-500');
                currentMeasurementDate = new Date();
                renderMeasurementView();
            });

            // --- Elemen Tampilan "Weight" ---
            const latestWeightDisplay = document.getElementById('latest-weight-display');
            const goalWeightDisplay = document.getElementById('goal-weight-display');
            const weightHistoryList = document.getElementById('weight-history-list');
            const historyFilter = document.getElementById('history-filter');
            const updateWeightModal = document.getElementById('update-weight-modal');
            const openUpdateModalBtn = document.getElementById('update-weight-btn');
            const closeUpdateModalBtn = document.getElementById('cancel-update-btn');
            const saveWeightBtn = document.getElementById('save-weight-btn');
            const newWeightInput = document.getElementById('new-weight-input');
            const entryDateInput = document.getElementById('entry-date-input');
            const setGoalModal = document.getElementById('set-goal-modal');
            const openSetGoalBtn = document.getElementById('set-goal-btn');
            const closeGoalModalBtn = document.getElementById('cancel-goal-btn');
            const saveGoalBtn = document.getElementById('save-goal-btn');
            const newGoalInput = document.getElementById('new-goal-input');

            // --- Elemen Tampilan "Body Measurement" ---
            const measurementDateDisplay = document.getElementById('measurement-date-display');
            const prevDayBtn = document.getElementById('prev-day-btn');
            const nextDayBtn = document.getElementById('next-day-btn');
            const measurementForm = document.getElementById('measurement-form');
            const saveMeasurementBtn = document.getElementById('save-measurement-btn');
            const measurementHistoryList = document.getElementById('measurement-history-list');
            
            let currentMeasurementDate = new Date();

            // Setup Grafik (Chart.js)
            const ctx = document.getElementById('weight-chart').getContext('2d');
            
            // Membuat gradient untuk area di bawah chart
            const chartArea = ctx.canvas.parentElement;
            const gradient = ctx.createLinearGradient(0, 0, 0, chartArea.clientHeight);
            gradient.addColorStop(0, 'rgba(236, 72, 153, 0.4)');
            gradient.addColorStop(1, 'rgba(236, 72, 153, 0)');

            const weightChart = new Chart(ctx, {
                type: 'line', 
                data: { 
                    labels: [], 
                    datasets: [{ 
                        label: 'Weight (kg)', 
                        data: [], 
                        borderColor: '#ec4899', // pink-500
                        tension: 0.4,
                        fill: true,
                        backgroundColor: gradient,
                        pointBackgroundColor: '#ec4899',
                        pointBorderColor: '#fff',
                        pointHoverRadius: 7,
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#ec4899',
                        pointHoverBorderWidth: 2
                    }] 
                },
                options: { 
                    plugins: { 
                        legend: { display: false } 
                    }, 
                    scales: { 
                        y: { 
                            beginAtZero: false,
                            grid: {
                                drawBorder: false,
                                color: '#f0f0f0'
                            }
                        },
                        x: {
                             grid: {
                                display: false
                             }
                        }
                    } 
                }
            });
            
            // KODE LAIN DARI progress.js YANG KAMU BERIKAN TETAP SAMA...
            // (Manajemen Data, Render, Event Listeners lainnya)
             function getWeightData() { return JSON.parse(localStorage.getItem('weightData')) || []; }
             function saveWeightData(data) {
                 data.sort((a, b) => new Date(b.date) - new Date(a.date));
                 localStorage.setItem('weightData', JSON.stringify(data));
             }
             function getGoalWeight() { return localStorage.getItem('goalWeight') || '--'; }
             function saveGoalWeight(goal) { localStorage.setItem('goalWeight', goal); }
             function getMeasurementData() { return JSON.parse(localStorage.getItem('measurementData')) || {}; }
             function saveMeasurementData(data) { localStorage.setItem('measurementData', JSON.stringify(data)); }
             function renderWeightView() {
                 const data = getWeightData();
                 const goal = getGoalWeight();
                 const latestWeight = data.length > 0 ? data[0].weight : '--';
                 latestWeightDisplay.textContent = `${latestWeight} kg`;
                 goalWeightDisplay.textContent = `${goal} kg`;
                 renderWeightHistoryList(data);
                 filterAndRenderChart();
             }
             function renderWeightHistoryList(data) {
                 weightHistoryList.innerHTML = '';
                 if (data.length === 0) {
                     weightHistoryList.innerHTML = '<p class="text-sm text-gray-500 text-center">No history yet.</p>'; return;
                 }
                 data.forEach(entry => {
                     const date = new Date(entry.date + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                     const timeHTML = entry.time ? `<span class="text-xs text-gray-400 ml-2">at ${entry.time}</span>` : '';
                     const listItem = `<div class="flex justify-between items-center py-1"><div><span class="text-sm text-gray-800">${date}</span>${timeHTML}</div><span class="font-semibold text-sm">${entry.weight} kg</span></div>`;
                     weightHistoryList.innerHTML += listItem;
                 });
             }
             function filterAndRenderChart() {
                 let data = getWeightData(); let filterValue = historyFilter.value; let filteredData = data;
                 if (filterValue !== 'all') {
                     let daysToFilter; if (filterValue === '4w') daysToFilter = 28; if (filterValue === '3m') daysToFilter = 90; if (filterValue === '6m') daysToFilter = 180;
                     const filterDate = new Date(new Date().setDate(new Date().getDate() - daysToFilter));
                     filteredData = data.filter(entry => new Date(entry.date) >= filterDate);
                 }
                 filteredData.reverse();
                 weightChart.data.labels = filteredData.map(d => new Date(d.date + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric'}));
                 weightChart.data.datasets[0].data = filteredData.map(d => d.weight); weightChart.update();
             }
             function renderMeasurementView() {
                 const today = new Date(); today.setHours(0, 0, 0, 0); currentMeasurementDate.setHours(0, 0, 0, 0);
                 if (today.getTime() === currentMeasurementDate.getTime()) {
                     measurementDateDisplay.textContent = "Today";
                 } else {
                     measurementDateDisplay.textContent = currentMeasurementDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric' });
                 }
                 nextDayBtn.disabled = today.getTime() <= currentMeasurementDate.getTime();
                 nextDayBtn.classList.toggle('opacity-50', nextDayBtn.disabled);
                 const dateKey = currentMeasurementDate.toISOString().split('T')[0];
                 const allData = getMeasurementData();
                 const dataForDate = allData[dateKey] || {};
                 measurementForm.querySelectorAll('input').forEach(input => {
                     input.value = dataForDate[input.name] || '';
                 });
                 renderMeasurementHistory();
             }
             function renderMeasurementHistory() {
                 measurementHistoryList.innerHTML = '';
                 const allData = getMeasurementData();
                 const sortedDates = Object.keys(allData).sort((a,b) => new Date(b) - new Date(a));
                 if (sortedDates.length === 0) {
                     measurementHistoryList.innerHTML = '<p class="text-sm text-gray-500 text-center">No history yet.</p>'; return;
                 }
                 sortedDates.forEach(dateKey => {
                     const data = allData[dateKey];
                     const date = new Date(dateKey + 'T00:00:00').toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric'});
                     let detailsHtml = '<ul class="text-xs text-gray-600 grid grid-cols-2 gap-x-4">';
                     Object.keys(data).forEach(key => {
                         if (data[key]) {
                            const label = key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());
                             detailsHtml += `<li class="flex justify-between"><span>${label}:</span><span class="font-medium">${data[key]} cm</span></li>`;
                         }
                     });
                     detailsHtml += '</ul>';
                     const listItem = `<div class="p-2 border-b border-gray-200/50"><p class="font-semibold text-sm mb-1 text-gray-900">${date}</p>${detailsHtml}</div>`;
                     measurementHistoryList.innerHTML += listItem;
                 });
             }

            openUpdateModalBtn.addEventListener('click', () => {
                 const todayString = new Date().toISOString().split('T')[0];
                 entryDateInput.value = todayString; entryDateInput.max = todayString;
                 updateWeightModal.classList.remove('hidden');
            });
            closeUpdateModalBtn.addEventListener('click', () => updateWeightModal.classList.add('hidden'));
            openSetGoalBtn.addEventListener('click', () => setGoalModal.classList.remove('hidden'));
            closeGoalModalBtn.addEventListener('click', () => setGoalModal.classList.add('hidden'));
            saveWeightBtn.addEventListener('click', () => {
                 const newWeight = parseFloat(newWeightInput.value); const selectedDate = entryDateInput.value;
                 if (!newWeight || newWeight <= 0) { alert('Please enter a valid weight.'); return; }
                 if (!selectedDate) { alert('Please select a date.'); return; }
                 const now = new Date(); const formattedTime = now.toTimeString().slice(0, 5);
                 let data = getWeightData(); const newEntry = { date: selectedDate, weight: newWeight, time: formattedTime };
                 const entryIndex = data.findIndex(entry => entry.date === selectedDate);
                 if (entryIndex > -1) { data[entryIndex] = newEntry; } else { data.push(newEntry); }
                 saveWeightData(data); renderWeightView(); updateWeightModal.classList.add('hidden'); newWeightInput.value = '';
            });
            saveGoalBtn.addEventListener('click', () => {
                 const newGoal = parseFloat(newGoalInput.value);
                 if (!newGoal || newGoal <= 0) { alert('Please enter a valid goal weight.'); return; }
                 saveGoalWeight(newGoal); renderWeightView(); setGoalModal.classList.add('hidden'); newGoalInput.value = '';
            });
            historyFilter.addEventListener('change', filterAndRenderChart);
            prevDayBtn.addEventListener('click', () => {
                 currentMeasurementDate.setDate(currentMeasurementDate.getDate() - 1);
                 renderMeasurementView();
            });
            nextDayBtn.addEventListener('click', () => {
                 currentMeasurementDate.setDate(currentMeasurementDate.getDate() + 1);
                 renderMeasurementView();
            });
            saveMeasurementBtn.addEventListener('click', () => {
                 const allData = getMeasurementData();
                 const dateKey = currentMeasurementDate.toISOString().split('T')[0];
                 let newDataForDate = {}; let hasValue = false;
                 measurementForm.querySelectorAll('input').forEach(input => {
                     if(input.value) {
                         newDataForDate[input.name] = parseFloat(input.value);
                         hasValue = true;
                     }
                 });
                 if (hasValue) { allData[dateKey] = newDataForDate; } else { delete allData[dateKey]; }
                 saveMeasurementData(allData);
                 renderMeasurementHistory();
                 saveMeasurementBtn.textContent = 'Saved!';
                 saveMeasurementBtn.classList.add('bg-green-500');
                 setTimeout(() => {
                     saveMeasurementBtn.textContent = 'Save Measurement';
                     saveMeasurementBtn.classList.remove('bg-green-500');
                 }, 1500);
            });
             renderWeightView();
        });
    </script>
</body>
</html>